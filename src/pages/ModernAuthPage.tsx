import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useNavigate } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';
import { useTheme } from '../context/ThemeContext';
import { Button } from '../components/ui/button';
import { Input } from '../components/ui/Input';
import { Badge } from '../components/ui/badge';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '../components/ui/tabs';
import { Switch } from '../components/ui/switch';
import { Avatar, AvatarFallback, AvatarImage } from '../components/ui/avatar';
import { 
  Github, 
  Mail, 
  Lock, 
  Eye, 
  EyeOff, 
  Sparkles, 
  Zap, 
  Globe, 
  BarChart3,
  ArrowRight,
  CheckCircle,
  Moon,
  Sun,
  Loader2
} from 'lucide-react';

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2
    }
  }
};

const itemVariants = {
  hidden: { opacity: 0, y: 20, scale: 0.95 },
  visible: {
    opacity: 1,
    y: 0,
    scale: 1,
    transition: {
      type: "spring",
      stiffness: 100,
      damping: 15
    }
  }
};

const floatingVariants = {
  animate: {
    y: [-10, 10, -10],
    rotate: [0, 5, -5, 0],
    transition: {
      duration: 6,
      repeat: Infinity,
      ease: "easeInOut"
    }
  }
};

export function ModernAuthPage() {\n  const [activeTab, setActiveTab] = useState('signin');\n  const [isLoading, setIsLoading] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [fullName, setFullName] = useState('');\n  const [rememberMe, setRememberMe] = useState(false);\n  \n  const { signInWithEmail, signUpWithEmail, signInWithGitHub, user } = useAuth();\n  const { currentTheme, toggleTheme } = useTheme();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    if (user) {\n      navigate('/dashboard');\n    }\n  }, [user, navigate]);\n\n  const handleEmailAuth = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      if (activeTab === 'signin') {\n        await signInWithEmail(email, password);\n      } else {\n        if (password !== confirmPassword) {\n          throw new Error('Passwords do not match');\n        }\n        await signUpWithEmail(email, password, fullName);\n      }\n    } catch (error) {\n      console.error('Auth error:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleGitHubAuth = async () => {\n    setIsLoading(true);\n    try {\n      await signInWithGitHub();\n    } catch (error) {\n      console.error('GitHub auth error:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const features = [\n    {\n      icon: BarChart3,\n      title: \"Real-time Analytics\",\n      description: \"Track performance metrics instantly\"\n    },\n    {\n      icon: Zap,\n      title: \"AI-Powered Insights\",\n      description: \"Get intelligent optimization suggestions\"\n    },\n    {\n      icon: Globe,\n      title: \"Global Monitoring\",\n      description: \"Monitor websites from multiple locations\"\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-primary-50 via-white to-accent-50 dark:from-primary-950 dark:via-primary-900 dark:to-accent-950 flex items-center justify-center p-4 relative overflow-hidden\">\n      {/* Animated Background Elements */}\n      <div className=\"absolute inset-0 overflow-hidden\">\n        <motion.div\n          className=\"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-primary-400/20 to-accent-400/20 rounded-full blur-3xl\"\n          variants={floatingVariants}\n          animate=\"animate\"\n        />\n        <motion.div\n          className=\"absolute -bottom-40 -left-40 w-96 h-96 bg-gradient-to-br from-accent-400/20 to-success-400/20 rounded-full blur-3xl\"\n          variants={{\n            animate: {\n              y: [10, -10, 10],\n              rotate: [0, -5, 5, 0],\n              transition: {\n                duration: 8,\n                repeat: Infinity,\n                ease: \"easeInOut\",\n                delay: 2\n              }\n            }\n          }}\n          animate=\"animate\"\n        />\n        <motion.div\n          className=\"absolute top-1/2 left-1/4 w-32 h-32 bg-gradient-to-br from-primary-300/10 to-accent-300/10 rounded-full blur-2xl\"\n          variants={{\n            animate: {\n              scale: [1, 1.2, 1],\n              opacity: [0.3, 0.6, 0.3],\n              transition: {\n                duration: 4,\n                repeat: Infinity,\n                ease: \"easeInOut\"\n              }\n            }\n          }}\n          animate=\"animate\"\n        />\n      </div>\n\n      <motion.div\n        className=\"w-full max-w-6xl mx-auto grid lg:grid-cols-2 gap-12 items-center relative z-10\"\n        variants={containerVariants}\n        initial=\"hidden\"\n        animate=\"visible\"\n      >\n        {/* Left Side - Branding and Features */}\n        <motion.div\n          className=\"space-y-8 text-center lg:text-left\"\n          variants={itemVariants}\n        >\n          {/* Logo and Title */}\n          <div className=\"space-y-4\">\n            <motion.div\n              className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-primary-100 to-accent-100 dark:from-primary-800 dark:to-accent-800 border border-primary-200 dark:border-primary-700\"\n              whileHover={{ scale: 1.05 }}\n              whileTap={{ scale: 0.95 }}\n            >\n              <Sparkles className=\"h-5 w-5 text-primary-600 dark:text-primary-400\" />\n              <span className=\"text-sm font-medium text-primary-700 dark:text-primary-300\">\n                LuminaWeb Analytics\n              </span>\n            </motion.div>\n            \n            <motion.h1\n              className=\"text-5xl lg:text-6xl font-bold bg-gradient-to-r from-primary-900 via-primary-700 to-accent-600 dark:from-primary-100 dark:via-primary-300 dark:to-accent-400 bg-clip-text text-transparent leading-tight\"\n              initial={{ opacity: 0, y: 30 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.5, duration: 0.8 }}\n            >\n              Optimize Your\n              <br />\n              <span className=\"relative\">\n                Website\n                <motion.div\n                  className=\"absolute -bottom-2 left-0 right-0 h-3 bg-gradient-to-r from-accent-400/40 to-primary-400/40 rounded-full\"\n                  initial={{ scaleX: 0 }}\n                  animate={{ scaleX: 1 }}\n                  transition={{ delay: 1.2, duration: 0.8 }}\n                />\n              </span>\n            </motion.h1>\n            \n            <motion.p\n              className=\"text-xl text-primary-600 dark:text-primary-400 max-w-md mx-auto lg:mx-0\"\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ delay: 0.7, duration: 0.8 }}\n            >\n              Advanced website analytics and AI-powered optimization insights for modern developers.\n            </motion.p>\n          </div>\n\n          {/* Features */}\n          <motion.div\n            className=\"space-y-4\"\n            variants={containerVariants}\n          >\n            {features.map((feature, index) => (\n              <motion.div\n                key={feature.title}\n                className=\"flex items-center gap-4 p-4 rounded-lg bg-white/50 dark:bg-primary-800/50 backdrop-blur-sm border border-primary-200/50 dark:border-primary-700/50\"\n                variants={itemVariants}\n                whileHover={{ scale: 1.02, x: 10 }}\n                transition={{ type: \"spring\", stiffness: 300 }}\n              >\n                <div className=\"flex-shrink-0\">\n                  <div className=\"w-12 h-12 rounded-lg bg-gradient-to-br from-primary-500 to-accent-500 flex items-center justify-center\">\n                    <feature.icon className=\"h-6 w-6 text-white\" />\n                  </div>\n                </div>\n                <div className=\"text-left\">\n                  <h3 className=\"font-semibold text-primary-900 dark:text-primary-100\">\n                    {feature.title}\n                  </h3>\n                  <p className=\"text-sm text-primary-600 dark:text-primary-400\">\n                    {feature.description}\n                  </p>\n                </div>\n                <CheckCircle className=\"h-5 w-5 text-success-500 ml-auto\" />\n              </motion.div>\n            ))}\n          </motion.div>\n        </motion.div>\n\n        {/* Right Side - Authentication Form */}\n        <motion.div\n          className=\"w-full max-w-md mx-auto\"\n          variants={itemVariants}\n        >\n          <motion.div\n            className=\"bg-white/80 dark:bg-primary-900/80 backdrop-blur-xl border border-primary-200/50 dark:border-primary-700/50 rounded-2xl shadow-2xl p-8 relative overflow-hidden\"\n            whileHover={{ y: -5 }}\n            transition={{ type: \"spring\", stiffness: 300 }}\n          >\n            {/* Gradient overlay */}\n            <div className=\"absolute inset-0 bg-gradient-to-br from-primary-500/5 to-accent-500/5 rounded-2xl\" />\n            \n            {/* Theme toggle */}\n            <div className=\"absolute top-4 right-4 z-10\">\n              <motion.button\n                onClick={toggleTheme}\n                className=\"p-2 rounded-lg bg-primary-100 dark:bg-primary-800 hover:bg-primary-200 dark:hover:bg-primary-700 transition-colors\"\n                whileHover={{ scale: 1.1 }}\n                whileTap={{ scale: 0.9 }}\n              >\n                {currentTheme === 'dark' ? (\n                  <Sun className=\"h-4 w-4 text-primary-600 dark:text-primary-400\" />\n                ) : (\n                  <Moon className=\"h-4 w-4 text-primary-600 dark:text-primary-400\" />\n                )}\n              </motion.button>\n            </div>\n\n            <div className=\"relative z-10\">\n              {/* Header */}\n              <div className=\"text-center mb-8\">\n                <motion.h2\n                  className=\"text-2xl font-bold text-primary-900 dark:text-primary-100 mb-2\"\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: 0.3 }}\n                >\n                  {activeTab === 'signin' ? 'Welcome Back' : 'Create Account'}\n                </motion.h2>\n                <motion.p\n                  className=\"text-primary-600 dark:text-primary-400\"\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  transition={{ delay: 0.5 }}\n                >\n                  {activeTab === 'signin' \n                    ? 'Sign in to access your analytics dashboard'\n                    : 'Join thousands of developers optimizing their websites'\n                  }\n                </motion.p>\n              </div>\n\n              {/* GitHub Sign In */}\n              <motion.div\n                className=\"mb-6\"\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.6 }}\n              >\n                <Button\n                  onClick={handleGitHubAuth}\n                  disabled={isLoading}\n                  className=\"w-full h-12 bg-gray-900 hover:bg-gray-800 text-white border-0 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-3\"\n                >\n                  {isLoading ? (\n                    <Loader2 className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <>\n                      <Github className=\"h-5 w-5\" />\n                      Continue with GitHub\n                      <ArrowRight className=\"h-4 w-4 ml-auto\" />\n                    </>\n                  )}\n                </Button>\n              </motion.div>\n\n              {/* Divider */}\n              <motion.div\n                className=\"relative mb-6\"\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                transition={{ delay: 0.8 }}\n              >\n                <div className=\"absolute inset-0 flex items-center\">\n                  <div className=\"w-full border-t border-primary-200 dark:border-primary-700\" />\n                </div>\n                <div className=\"relative flex justify-center text-sm\">\n                  <span className=\"px-4 bg-white dark:bg-primary-900 text-primary-500 dark:text-primary-400\">\n                    or continue with email\n                  </span>\n                </div>\n              </motion.div>\n\n              {/* Tabs */}\n              <Tabs value={activeTab} onValueChange={setActiveTab} className=\"mb-6\">\n                <TabsList className=\"grid w-full grid-cols-2 mb-6\">\n                  <TabsTrigger value=\"signin\">Sign In</TabsTrigger>\n                  <TabsTrigger value=\"signup\">Sign Up</TabsTrigger>\n                </TabsList>\n\n                <AnimatePresence mode=\"wait\">\n                  <TabsContent value=\"signin\">\n                    <motion.form\n                      onSubmit={handleEmailAuth}\n                      className=\"space-y-4\"\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      exit={{ opacity: 0, x: 20 }}\n                      transition={{ duration: 0.3 }}\n                    >\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium text-primary-700 dark:text-primary-300\">\n                          Email\n                        </label>\n                        <div className=\"relative\">\n                          <Mail className=\"absolute left-3 top-3 h-4 w-4 text-primary-400\" />\n                          <Input\n                            type=\"email\"\n                            value={email}\n                            onChange={(e) => setEmail(e.target.value)}\n                            placeholder=\"your@email.com\"\n                            className=\"pl-10 h-12\"\n                            required\n                          />\n                        </div>\n                      </div>\n\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium text-primary-700 dark:text-primary-300\">\n                          Password\n                        </label>\n                        <div className=\"relative\">\n                          <Lock className=\"absolute left-3 top-3 h-4 w-4 text-primary-400\" />\n                          <Input\n                            type={showPassword ? \"text\" : \"password\"}\n                            value={password}\n                            onChange={(e) => setPassword(e.target.value)}\n                            placeholder=\"••••••••\"\n                            className=\"pl-10 pr-10 h-12\"\n                            required\n                          />\n                          <button\n                            type=\"button\"\n                            onClick={() => setShowPassword(!showPassword)}\n                            className=\"absolute right-3 top-3 text-primary-400 hover:text-primary-600\"\n                          >\n                            {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                          </button>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center space-x-2\">\n                          <Switch\n                            id=\"remember\"\n                            checked={rememberMe}\n                            onCheckedChange={setRememberMe}\n                          />\n                          <label htmlFor=\"remember\" className=\"text-sm text-primary-600 dark:text-primary-400\">\n                            Remember me\n                          </label>\n                        </div>\n                        <button\n                          type=\"button\"\n                          className=\"text-sm text-primary-600 hover:text-primary-800 dark:text-primary-400 dark:hover:text-primary-200\"\n                        >\n                          Forgot password?\n                        </button>\n                      </div>\n\n                      <Button\n                        type=\"submit\"\n                        disabled={isLoading}\n                        className=\"w-full h-12 bg-gradient-to-r from-primary-600 to-accent-600 hover:from-primary-700 hover:to-accent-700 text-white border-0 rounded-lg font-medium transition-all duration-200\"\n                      >\n                        {isLoading ? (\n                          <Loader2 className=\"h-5 w-5 animate-spin\" />\n                        ) : (\n                          <>Sign In<ArrowRight className=\"h-4 w-4 ml-2\" /></>\n                        )}\n                      </Button>\n                    </motion.form>\n                  </TabsContent>\n\n                  <TabsContent value=\"signup\">\n                    <motion.form\n                      onSubmit={handleEmailAuth}\n                      className=\"space-y-4\"\n                      initial={{ opacity: 0, x: 20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      exit={{ opacity: 0, x: -20 }}\n                      transition={{ duration: 0.3 }}\n                    >\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium text-primary-700 dark:text-primary-300\">\n                          Full Name\n                        </label>\n                        <Input\n                          type=\"text\"\n                          value={fullName}\n                          onChange={(e) => setFullName(e.target.value)}\n                          placeholder=\"John Doe\"\n                          className=\"h-12\"\n                          required\n                        />\n                      </div>\n\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium text-primary-700 dark:text-primary-300\">\n                          Email\n                        </label>\n                        <div className=\"relative\">\n                          <Mail className=\"absolute left-3 top-3 h-4 w-4 text-primary-400\" />\n                          <Input\n                            type=\"email\"\n                            value={email}\n                            onChange={(e) => setEmail(e.target.value)}\n                            placeholder=\"your@email.com\"\n                            className=\"pl-10 h-12\"\n                            required\n                          />\n                        </div>\n                      </div>\n\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium text-primary-700 dark:text-primary-300\">\n                          Password\n                        </label>\n                        <div className=\"relative\">\n                          <Lock className=\"absolute left-3 top-3 h-4 w-4 text-primary-400\" />\n                          <Input\n                            type={showPassword ? \"text\" : \"password\"}\n                            value={password}\n                            onChange={(e) => setPassword(e.target.value)}\n                            placeholder=\"••••••••\"\n                            className=\"pl-10 pr-10 h-12\"\n                            required\n                          />\n                          <button\n                            type=\"button\"\n                            onClick={() => setShowPassword(!showPassword)}\n                            className=\"absolute right-3 top-3 text-primary-400 hover:text-primary-600\"\n                          >\n                            {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                          </button>\n                        </div>\n                      </div>\n\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium text-primary-700 dark:text-primary-300\">\n                          Confirm Password\n                        </label>\n                        <Input\n                          type=\"password\"\n                          value={confirmPassword}\n                          onChange={(e) => setConfirmPassword(e.target.value)}\n                          placeholder=\"••••••••\"\n                          className=\"h-12\"\n                          required\n                        />\n                      </div>\n\n                      <Button\n                        type=\"submit\"\n                        disabled={isLoading}\n                        className=\"w-full h-12 bg-gradient-to-r from-primary-600 to-accent-600 hover:from-primary-700 hover:to-accent-700 text-white border-0 rounded-lg font-medium transition-all duration-200\"\n                      >\n                        {isLoading ? (\n                          <Loader2 className=\"h-5 w-5 animate-spin\" />\n                        ) : (\n                          <>Create Account<ArrowRight className=\"h-4 w-4 ml-2\" /></>\n                        )}\n                      </Button>\n                    </motion.form>\n                  </TabsContent>\n                </AnimatePresence>\n              </Tabs>\n\n              {/* Footer */}\n              <motion.p\n                className=\"text-center text-sm text-primary-500 dark:text-primary-400\"\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                transition={{ delay: 1 }}\n              >\n                By continuing, you agree to our Terms of Service and Privacy Policy.\n              </motion.p>\n            </div>\n          </motion.div>\n        </motion.div>\n      </motion.div>\n    </div>\n  );\n}